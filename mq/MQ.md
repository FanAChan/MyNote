
#### 作用
1. 服务解耦
2. 流量控制，削锋填谷
3. 异步处理

#### 缺点
1. 引入新的组件，服务宕机的几率增大，系统可用性降低。
2. 复杂性提高，产生系统问题


#### 问题
###### 保证服务高可用
1. 单实例
2. 主从
3. 分布式

###### 重复消费问题
- 产生，重复消费问题不可避免
1. 重复生产：中间件已经接收到生产者发送的消息，但未进行确认导致生产者重发。
2. 重复消费：消费者消费了但是未提交确认后重启，导致重新消费
3. 消息重试机制：消费失败MQ进行重试

- 解决：保证消息消费的幂等性
1. 业务内判断
2. 分布式锁
3. 唯一ID标识消费记录

###### 消息丢失问题可靠性保证
1. 发送过程丢失  
    1.1 接受确认机制  
    1.2 事务机制，失败重试（事务是同步的，提交事务后阻塞等待，接受确认是异步的）
2. 存储过程丢失
    2.1 持久化功能，保证组件挂了之后可以恢复，但还是可能会导致少量数据丢失（接受消息后未持久化到磁盘中时挂了）  
    2.2 持久化后再confim则不会，未持久化成功不进行confirm生产者重新发送
3. 消费过程丢失：接受消息后未进行处理或处理未完成消费者挂了，mq认为消息已消费  
    3.1 消费完成确认

###### 顺序性问题
1. RocketMQ的topci内的队列机制（Queue)的FIFO

###### 一致性问题：部分处理成功，部分处理失败，导致系统不一致
1. 分布式事务
2. 最终一致性


- 推模式
    + 优点
        * 

